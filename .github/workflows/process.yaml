name: Photovote-process-deployment
on: 
    push: 
        branches: ["master"]
        paths: ["process/**"]

jobs: 
    Deploy:
        runs-on: ubuntu-latest
        steps: 
           - name: ssh into the server deploy process service
             uses:  appleboy/ssh-action@v1
             with: 
                host: ${{ secrets.HOST }}
                username: root
                key: ${{ secrets.SSH_SECRETS }}
                port: 22
                script: | 
                    ls
                    cd photovote-backend
                    cd process
                    git pull
                    npm install
                    npm run build
                    pm2 restart photovote-listener
                    pm2 restart photovote-worker